D1uL	EQU	D'2'			
DR1uL	EQU	0x0D		
	ORG	0x00
	BRA	MAIN			
	ORG	0x08
	BTFSC	 INTCON,INT0IF 	
	BRA	INT0_ISR		
	RETFIE
	ORG	0x28
MAIN	CLRF	TRISC	  		
	BSF	TRISC,SDI 		
	BSF	TRISC,RX  		
	BSF	TRISB,INT0		
	MOVLW	0x00
	MOVWF	SSPSTAT		
	MOVLW	0x22
	MOVWF	SSPCON1 		
	BCF	INTCON2,INTEDG0	
					
	BSF	INTCON,INT0IE	
   	MOVLW B'00100000'
   	MOVWF TXSTA        	
   	MOVLW D'15'    	
   	MOVWF SPBRG         	
   	BCF	TRISC, TX 	
   	BSF	RCSTA, SPEN    	
	BSF	INTCON,GIE		
	BSF	PORTC,RC2 		
	CALL	SDELAY
	MOVLW 0x8F	   		
	CALL	SPI
	MOVLW 0x0		   	
	CALL	SPI
	BCF	PORTC,RC2		
	CALL	SDELAY
	BSF	PORTC,RC2 	
	MOVLW 0x87   		
	CALL SPI 			
	MOVLW 0x08   		
	CALL SPI 			
	MOVLW 0x80   		
	CALL SPI 			
	MOVLW 0x80   		
	CALL SPI 			
	MOVLW 0x80   		
	CALL SPI 			
	BCF PORTC,RC2		
	CALL SDELAY
	BSF	PORTC,RC2 		
	CALL SDELAY
	MOVLW 0x8F   		
	CALL SPI
	MOVLW 0x01   		
	CALL SPI
	BCF PORTC,RC2		
	CALL	SDELAY
LOOP	BRA LOOP			
INT0_ISR
	BSF	PORTC,RC2		
	CALL SDELAY
	MOVLW 0x8F   		
	CALL SPI
	MOVLW 0x04   		
	CALL SPI
	BCF PORTC,RC2		
	CALL SDELAY
	BSF	PORTC,RC2 		
	CALL SDELAY
	MOVLW 0x87   		
	CALL SPI
	MOVLW 0x08   		
	CALL SPI
	BCF PORTC,RC2		
	CALL SDELAY
	MOVLW	upper(MESSAGE)
	MOVWF	TBLPTRU
	MOVLW	high(MESSAGE)
	MOVWF	TBLPTRH
	MOVLW	low(MESSAGE)
	MOVWF	TBLPTRL
NEXT	TBLRD*+			
	MOVF 	TABLAT,W		
	IORLW	0x0
	BZ	OVER			
	CALL 	TRANS			
	BRA 	NEXT			
OVER	BSF	PORTC,RC2 		
	CALL	SDELAY
	MOVLW 0x8F   		
	CALL	SPI
	MOVLW 0x01   		
	CALL	SPI
	BCF PORTC,RC2		
	CALL	SDELAY
	BCF	INTCON,INT0IF
	RETFIE
	RETURN
MESSAGE:	DB	0x0A,0x0D,"Yes",0
	END
